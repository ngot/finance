<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BX6DXWDXHC"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-BX6DXWDXHC');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Investment Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="languages.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector">
                <button id="langEn" class="lang-btn active">English</button>
                <button id="langZh" class="lang-btn">中文</button>
            </div>
            <h1 data-i18n="title">Property Investment Calculator</h1>
            <p class="subtitle" data-i18n="subtitle">Evaluate cash flow, capital growth and tax implications of property investments</p>
        </header>

        <!-- Profile Management -->
        <div class="profile-section">
            <h2 data-i18n="profile_management">Investment Portfolio Management</h2>
            <div class="profile-controls">
                <div class="profile-selector">
                    <label for="profileSelect" data-i18n="current_profile">Current Profile:</label>
                    <select id="profileSelect">
                        <option value="default" data-i18n="default_profile">Default Profile</option>
                    </select>
                </div>
                <div class="profile-actions">
                    <button id="newProfileBtn" class="profile-btn" data-i18n="new_profile">New Profile</button>
                    <button id="saveProfileBtn" class="profile-btn" data-i18n="save_profile">Save Profile</button>
                    <button id="deleteProfileBtn" class="profile-btn delete-btn" data-i18n="delete_profile">Delete Profile</button>
                    <button id="loadExampleBtn" class="profile-btn example-btn" data-i18n="load_example">Load Example</button>
                    <button id="exportBtn" class="profile-btn export-btn" data-i18n="export_data">Export Data</button>
                    <button id="importBtn" class="profile-btn import-btn" data-i18n="import_data">Import Data</button>
                </div>
                <input type="file" id="importFileInput" accept=".json" style="display: none;">
            </div>
        </div>

        <!-- Input Form -->
        <div class="input-section">
            <h2 data-i18n="investment_info_input">Investment Information Input</h2>
            
            <!-- Property Information -->
            <div class="form-group">
                <h3 data-i18n="property_info">Property Information</h3>
                <div class="input-row">
                    <label for="purchasePrice" data-i18n="purchase_price">Purchase Price (AUD)</label>
                    <input type="number" id="purchasePrice" data-i18n-placeholder="purchase_price_placeholder" placeholder="e.g.: 800000">
                </div>
                <div class="input-row">
                    <label for="purchaseCosts" data-i18n="purchase_costs">Purchase Costs (AUD)</label>
                    <input type="number" id="purchaseCosts" data-i18n-placeholder="purchase_costs_placeholder" placeholder="e.g.: 40000">
                </div>
                <div class="input-row">
                    <label for="weeklyRent" data-i18n="weekly_rent">Weekly Rent (AUD)</label>
                    <input type="number" id="weeklyRent" data-i18n-placeholder="weekly_rent_placeholder" placeholder="e.g.: 600">
                </div>
                <div class="input-row">
                    <label for="rentalGrowthRate" data-i18n="rental_growth_rate">Annual Rental Growth Rate (%)</label>
                    <input type="number" id="rentalGrowthRate" step="0.1" data-i18n-placeholder="rental_growth_rate_placeholder" placeholder="e.g.: 3.0">
                </div>
                <div class="input-row">
                    <label for="propertyType" data-i18n="property_type">Property Type</label>
                    <select id="propertyType">
                        <option value="house" data-i18n="house">House</option>
                        <option value="apartment" data-i18n="apartment">Apartment</option>
                        <option value="townhouse" data-i18n="townhouse">Townhouse</option>
                    </select>
                </div>
            </div>

            <!-- Loan Information -->
            <div class="form-group">
                <h3 data-i18n="loan_info">Loan Information</h3>
                <div class="input-row">
                    <label for="loanAmount" data-i18n="loan_amount">Loan Amount (AUD)</label>
                    <input type="number" id="loanAmount" data-i18n-placeholder="loan_amount_placeholder" placeholder="e.g.: 640000">
                </div>
                <div class="input-row">
                    <label for="interestRate" data-i18n="interest_rate">Interest Rate (%)</label>
                    <input type="number" id="interestRate" step="0.01" data-i18n-placeholder="interest_rate_placeholder" placeholder="e.g.: 6.5">
                </div>
                <div class="input-row">
                    <label for="loanTerm" data-i18n="loan_term">Loan Term (Years)</label>
                    <input type="number" id="loanTerm" data-i18n-placeholder="loan_term_placeholder" placeholder="e.g.: 30">
                </div>
                <div class="input-row">
                    <label for="repaymentType" data-i18n="repayment_type">Repayment Type</label>
                    <select id="repaymentType">
                        <option value="principal_interest" data-i18n="principal_interest">Principal & Interest</option>
                        <option value="interest_only" data-i18n="interest_only">Interest Only</option>
                    </select>
                </div>
            </div>

            <!-- Operating Expenses -->
            <div class="form-group">
                <h3 data-i18n="operating_expenses">Operating Expenses</h3>
                <div class="input-row">
                    <label for="strataFees" data-i18n="strata_fees">Annual Strata Fees (AUD)</label>
                    <input type="number" id="strataFees" data-i18n-placeholder="strata_fees_placeholder" placeholder="e.g.: 3000">
                </div>
                <div class="input-row">
                    <label for="councilRates" data-i18n="council_rates">Annual Council Rates (AUD)</label>
                    <input type="number" id="councilRates" data-i18n-placeholder="council_rates_placeholder" placeholder="e.g.: 2000">
                </div>
                <div class="input-row">
                    <label for="waterRates" data-i18n="water_rates">Annual Water Rates (AUD)</label>
                    <input type="number" id="waterRates" data-i18n-placeholder="water_rates_placeholder" placeholder="e.g.: 800">
                </div>
                <div class="input-row">
                    <label for="insurance" data-i18n="insurance">Annual Insurance (AUD)</label>
                    <input type="number" id="insurance" data-i18n-placeholder="insurance_placeholder" placeholder="e.g.: 1200">
                </div>
                <div class="input-row">
                    <label for="maintenance" data-i18n="maintenance">Annual Maintenance & Repairs (AUD)</label>
                    <input type="number" id="maintenance" data-i18n-placeholder="maintenance_placeholder" placeholder="e.g.: 2000">
                </div>
                <div class="input-row">
                    <label for="managementFees" data-i18n="management_fees">Property Management Fees (%)</label>
                    <input type="number" id="managementFees" step="0.1" data-i18n-placeholder="management_fees_placeholder" placeholder="e.g.: 7.0">
                </div>
            </div>

            <!-- Personal Tax Information -->
            <div class="form-group">
                <h3 data-i18n="personal_tax_info">Personal Tax Information</h3>
                <div class="input-row">
                    <label for="personalIncome" data-i18n="personal_income">Annual Personal Income (AUD)</label>
                    <input type="number" id="personalIncome" data-i18n-placeholder="personal_income_placeholder" placeholder="e.g.: 120000">
                </div>
                <div class="input-row">
                    <label for="otherDeductions" data-i18n="other_deductions">Other Tax Deductions (AUD)</label>
                    <input type="number" id="otherDeductions" data-i18n-placeholder="other_deductions_placeholder" placeholder="e.g.: 5000">
                </div>
            </div>

            <!-- Investment Assumptions -->
            <div class="form-group">
                <h3 data-i18n="investment_assumptions">Investment Assumptions</h3>
                <div class="input-row">
                    <label for="capitalGrowthRate" data-i18n="capital_growth_rate">Annual Capital Growth Rate (%)</label>
                    <input type="number" id="capitalGrowthRate" step="0.1" data-i18n-placeholder="capital_growth_rate_placeholder" placeholder="e.g.: 5.0">
                </div>
                <div class="input-row">
                    <label for="holdingPeriod" data-i18n="holding_period">Holding Period (Years)</label>
                    <input type="number" id="holdingPeriod" data-i18n-placeholder="holding_period_placeholder" placeholder="e.g.: 10">
                </div>
            </div>

            <button id="calculateBtn" class="calculate-btn" data-i18n="calculate_investment">Calculate Investment Returns</button>
        </div>

        <!-- Results Display Area -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <h2 data-i18n="results_title">Investment Analysis Report</h2>
            
            <!-- Overview -->
            <div class="result-group">
                <h3 data-i18n="investment_overview">Investment Overview</h3>
                <div class="overview-grid">
                    <div class="overview-item clickable-item" onclick="openInitialInvestmentModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="initial_investment">Total Initial Investment</span>
                            <span class="value" id="totalInitialInvestment">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                    <div class="overview-item">
                        <span class="label" data-i18n="expected_holding_period">Expected Holding Period</span>
                        <span class="value" id="displayHoldingPeriod">-</span>
                    </div>
                    <div class="overview-item">
                        <span class="label" data-i18n="expected_property_value">Expected Property Value at Sale</span>
                        <span class="value" id="futurePropertyValue">-</span>
                    </div>
                    <div class="overview-item">
                        <span class="label" data-i18n="gross_rental_yield">Gross Rental Yield</span>
                        <span class="value" id="grossRentalYield">-</span>
                    </div>
                    <div class="overview-item">
                        <span class="label" data-i18n="net_rental_yield">Net Rental Yield</span>
                        <span class="value" id="netRentalYield">-</span>
                    </div>
                </div>
            </div>

            <!-- Investment Return Analysis -->
            <div class="result-group">
                <h3 data-i18n="return_analysis">Investment Return Analysis</h3>
                <div class="return-grid">
                    <div class="return-item clickable-item" onclick="openCapitalGrowthModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="capital_growth">Total Capital Growth</span>
                            <span class="value" id="totalCapitalGrowth">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                    <div class="return-item clickable-item" onclick="openRentalIncomeModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="total_rental_income">Total Rental Income</span>
                            <span class="value" id="totalRentalIncome">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                    <div class="return-item tax-benefits-item">
                        <div class="tax-benefits-header" onclick="openTaxBenefitsModal()">
                            <div class="tax-benefits-main">
                                <span class="label" data-i18n="total_tax_benefits">Total Tax Benefits</span>
                                <span class="value" id="totalTaxBenefits">-</span>
                            </div>
                            <span class="detail-icon">🔍</span>
                        </div>
                    </div>
                    <div class="return-item clickable-item" onclick="openAfterTaxReturnModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="total_return">Total After-Tax Return</span>
                            <span class="value" id="totalAfterTaxReturn">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                    <div class="return-item clickable-item" onclick="openIrrModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="irr">Internal Rate of Return (IRR)</span>
                            <span class="value" id="irr">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                </div>
            </div>

            <!-- Tax Summary -->
            <div class="result-group">
                <h3 data-i18n="tax_summary">Tax Summary</h3>
                <div class="tax-summary">
                    <div class="tax-item clickable-item" onclick="openTotalDeductionsModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="total_deductions">Total Tax Deductions</span>
                            <span class="value" id="totalDeductions">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                    <div class="tax-item clickable-item" onclick="openCgtModal()">
                        <div class="item-content">
                            <span class="label" data-i18n="cgt_payable">Capital Gains Tax Payable</span>
                            <span class="value" id="capitalGainsTax">-</span>
                        </div>
                        <span class="detail-icon">🔍</span>
                    </div>
                    <div class="tax-item">
                        <span class="label" data-i18n="cgt_discount">CGT 50% Discount Applied</span>
                        <span class="value" id="cgtDiscountApplicable">-</span>
                    </div>
                </div>
            </div>

            <!-- Selling Time Recommendations -->
            <div class="result-group">
                <h3 data-i18n="selling_recommendations">Selling Time Recommendations</h3>
                <div id="sellingRecommendation" class="recommendation">
                    <!-- Dynamically generated recommendation content -->
                </div>
            </div>

            <!-- 现金流图表 - 移到最下面 -->
            <div class="result-group chart-section">
                <h3 data-i18n="cash_flow_chart_title">Annual Cash Flow Analysis Chart</h3>
                <div class="chart-container">
                    <canvas id="cashFlowChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tax Benefits Details Modal -->
        <div id="taxBenefitsModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 data-i18n="tax_benefits_detailed_analysis">Tax Benefits Detailed Analysis</h3>
                    <span class="close-btn" onclick="closeTaxBenefitsModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="modal-summary">
                        <div class="summary-card">
                            <h4 data-i18n="total_tax_benefits_amount">Total Tax Benefits Amount</h4>
                            <div class="summary-amount" id="modalTotalBenefits">-</div>
                            <div class="summary-details">
                                <span><span data-i18n="benefit_years">Benefit Years</span>: <strong id="modalBenefitYears">-</strong></span>
                                <span><span data-i18n="marginal_tax_rate">Marginal Tax Rate</span>: <strong id="modalTaxRate">-</strong></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-tabs">
                        <button class="tab-btn active" onclick="switchTab('yearly')" data-i18n="yearly_details">Annual Details</button>
                        <button class="tab-btn" onclick="switchTab('breakdown')" data-i18n="deduction_breakdown">Deduction Breakdown</button>
                        <button class="tab-btn" onclick="switchTab('explanation')" data-i18n="tax_explanation">Tax Explanation</button>
                    </div>
                    
                    <div class="tab-content">
                        <!-- Annual Details Tab -->
                        <div id="yearlyTab" class="tab-pane active">
                            <div id="yearlyDetailContent">
                                <!-- Dynamically generated annual details -->
                            </div>
                        </div>
                        
                        <!-- Deduction Breakdown Tab -->
                        <div id="breakdownTab" class="tab-pane">
                            <div id="breakdownDetailContent">
                                <!-- Dynamically generated deduction breakdown -->
                            </div>
                        </div>
                        
                        <!-- Tax Explanation Tab -->
                        <div id="explanationTab" class="tab-pane">
                            <div class="tax-explanation-detailed">
                                <h5 data-i18n="australian_property_tax_mechanism">Australian Property Investment Tax Mechanism</h5>
                                
                                <div class="explanation-section">
                                    <h6 data-i18n="negative_gearing_title">1. Negative Gearing</h6>
                                    <p data-i18n="negative_gearing_description">When the deductible expenses of a property investment exceed rental income, the resulting loss can be offset against the investor's other taxable income, thereby reducing overall tax liability.</p>
                                    <ul>
                                        <li data-i18n="negative_gearing_point1">Applies to all types of investment properties</li>
                                        <li data-i18n="negative_gearing_point2">Loss amount calculated as tax benefit at investor's marginal tax rate</li>
                                        <li data-i18n="negative_gearing_point3">Unused losses can be carried forward across tax years</li>
                                    </ul>
                                </div>
                                
                                <div class="explanation-section">
                                    <h6 data-i18n="main_deductible_expenses">2. Main Deductible Expenses</h6>
                                    <ul>
                                        <li><strong data-i18n="loan_interest_expense">Loan Interest:</strong> <span data-i18n="loan_interest_description">Interest portion of investment property loans</span></li>
                                        <li><strong data-i18n="property_management_fees_expense">Property Management Fees:</strong> <span data-i18n="property_management_description">Apartment strata fees, etc.</span></li>
                                        <li><strong data-i18n="council_fees_expense">Council Fees:</strong> <span data-i18n="council_fees_description">Council rates, water rates, etc.</span></li>
                                        <li><strong data-i18n="insurance_expense">Insurance:</strong> <span data-i18n="insurance_description">Landlord insurance premiums</span></li>
                                        <li><strong data-i18n="maintenance_expense">Maintenance:</strong> <span data-i18n="maintenance_description">Repair and maintenance costs</span></li>
                                        <li><strong data-i18n="agent_fees_expense">Agent Fees:</strong> <span data-i18n="agent_fees_description">Rental management fees</span></li>
                                        <li><strong data-i18n="depreciation_expense">Depreciation:</strong> <span data-i18n="depreciation_description">Building and equipment depreciation</span></li>
                                    </ul>
                                </div>
                                
                                <div class="explanation-section">
                                    <h6 data-i18n="depreciation_calculation">3. Depreciation Calculation</h6>
                                    <ul>
                                        <li><strong>Division 43:</strong> <span data-i18n="division43_description">Building structure depreciation, 2.5%/year for new buildings, 40 years</span></li>
                                        <li><strong>Division 40:</strong> <span data-i18n="division40_description">Equipment depreciation, such as air conditioning, carpets, etc.</span></li>
                                        <li data-i18n="depreciation_eligibility">Only properties built after 1987 can claim building depreciation</li>
                                    </ul>
                                </div>
                                
                                <div class="explanation-section">
                                    <h6 data-i18n="tax_rate_impact">4. Tax Rate Impact</h6>
                                    <p data-i18n="tax_benefit_formula">Tax Benefit Amount = Loss Amount × Marginal Tax Rate</p>
                                    <div class="tax-brackets">
                                        <div class="bracket">$0 - $18,200: 0%</div>
                                        <div class="bracket">$18,201 - $45,000: 19%</div>
                                        <div class="bracket">$45,001 - $120,000: 32.5%</div>
                                        <div class="bracket">$120,001 - $180,000: 37%</div>
                                        <div class="bracket">$180,001+: 45%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generic Details Modal -->
        <div id="detailModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle" data-i18n="detailed_information">Detailed Information</h3>
                    <span class="close-btn" onclick="closeDetailModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="modal-summary">
                        <div class="summary-card">
                            <h4 id="modalSummaryTitle">-</h4>
                            <div class="summary-amount" id="modalSummaryAmount">-</div>
                            <div class="summary-details" id="modalSummaryDetails">
                                <!-- Dynamically generated summary details -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-tabs" id="modalTabs">
                        <!-- Dynamically generated tabs -->
                    </div>
                    
                    <div class="tab-content" id="modalTabContent">
                        <!-- Dynamically generated tab content -->
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="disclaimer">
                <h4 data-i18n="disclaimer_title">Disclaimer</h4>
                <p data-i18n="disclaimer_content">All calculations provided by this calculator are based on user-entered assumptions and predictions and are for reference only. Actual results may vary due to market fluctuations, policy changes, and other factors. This tool does not constitute professional tax or investment advice. Users should consult qualified professional advisors before making any investment decisions.</p>
            </div>
        </footer>
    </div>

    <script src="calculator.js"></script>
</body>
</html>